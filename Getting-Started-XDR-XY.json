{
  "workflow": {
    "unique_name": "definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5",
    "name": "Getting-Started-XDR-XY - Incomplete",
    "title": "Getting-Started-XDR-XY - Incomplete",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "{\n    \"house\": {\n        \"name\": \"house\", \n        \"money\": 0\n        }, \n    \"players\": \n        [ ], \n    \"playerturn\": {}, \n\t\t  \n    \"gameid\": \"2mKYQR-klZ6XahlIAAAD\"\n} ",
          "scope": "local",
          "name": "Data Format",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_025ZDVC7FYCGA3ukB2fcwH5oyNXMeP3IqvC",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "local",
          "name": "Unique Name Check",
          "type": "datatype.boolean",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_025ZDVC7FXGYU6ZruESuGRYbgYrdZt40R6O",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": true,
          "scope": "input",
          "name": "Test Run",
          "type": "datatype.boolean",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_025ZDVC7FY2YS2uds4OknazVgIsPiKkIwyh",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "game_counter",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_025ZDVC7FXSD10HOhiDIE3zMYFgrWWRazLk",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "Cisco Live Session: SecureX Blackjack!",
      "display_name": "Getting-Started-XDR-XY - Incomplete",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "no_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_025ZDVCAG77OU4p7ctTwA3nbbD9GRUlSzKL",
        "name": "Condition Block",
        "title": "Determine Whether To Launch SecureX Blackjack!",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Determine Whether To Launch SecureX Blackjack!",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_025ZDVCB60GJP6O41hwGrIwBhRUx7TXW3tX",
            "name": "Condition Branch",
            "title": "All Tests Passed And Game is Running",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": {
                    "left_operand": "",
                    "operator": "eq",
                    "right_operand": "TO DO"
                  },
                  "operator": "and",
                  "right_operand": {
                    "left_operand": "$workflow.definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5.input.variable_workflow_025ZDVC7FY2YS2uds4OknazVgIsPiKkIwyh$",
                    "operator": "eq",
                    "right_operand": false
                  }
                },
                "operator": "and",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5.local.variable_workflow_025ZDVC7FXGYU6ZruESuGRYbgYrdZt40R6O$",
                  "operator": "eq",
                  "right_operand": true
                }
              },
              "continue_on_failure": false,
              "display_name": "All Tests Passed And Game is Running",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_025ZDVCCXF6Y47dln5Z2PnWhyiahLU8uhDc",
                "name": "Initialize Blackjack Game",
                "title": "Initialize Blackjack Game",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "This Atomic Function generates a random game_id and sends this, along with the input username, to the player's game client. This initializes the game of Blackjack for the game client. This information is also stored in the XDR global data record, \"Blackjack Game History\".",
                  "display_name": "Initialize Blackjack Game",
                  "input": {
                    "variable_workflow_025V8W920O2TD0fWvQBm8KDa7EwBQJJFPwc": "TO DO: Select Input Variable - Participant Name"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "no_target": true
                  },
                  "workflow_id": "definition_workflow_025V8SI32E1I61pxPwmzoVOSRbgkfQ9B0qh",
                  "workflow_name": "Initialize Blackjack Game"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_025ZDVCDX75QF5tAgmLhTSbl5WqtrWS2IxW",
                "name": "While Loop",
                "title": "While Game Is Active",
                "type": "logic.while",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "description": "This loop occurs for the duration of the session. ",
                  "display_name": "While Game Is Active",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_025ZDVCEQC7CK6IMj80VoT8TkrNBN3basMW",
                    "name": "Condition Branch",
                    "title": "If game_counter < 500",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": "$workflow.definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5.local.variable_workflow_025ZDVC7FXSD10HOhiDIE3zMYFgrWWRazLk$",
                          "operator": "lt",
                          "right_operand": 500
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$global.variable_025R2OZ4IU8AH1cybIGaZ71aQ8d6OxuxKrQ.global.variable_025R2OZ4IU8AH1cybIGaZ71aQ8d6OxuxKrQ$",
                          "operator": "eq",
                          "right_operand": true
                        }
                      },
                      "continue_on_failure": false,
                      "description": "This is the exit condition of our while loop. In this case, we update a counter called \"game_counter\" up to 500, at which point the game of Blackjack will conclude. ",
                      "display_name": "If game_counter < 500",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_025ZDVCG4BZQU3PFrR6qQTOVFlGjvQiyjnH",
                        "name": "Execute Python Script",
                        "title": "Get Game State From The User's Client",
                        "type": "python3.script",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "description": "This activity block allows us to insert Python code into our XDR Orchestration workflow! In this case, we input the client URL and make a \"Get\" request to our client to obtain information on the current state of the game. In particular, we want to keep track of earnings as hands are being played and store this information globally. ",
                          "display_name": "Get Game State From The User's Client",
                          "script": "import sys, json, requests\n\n#Load client url into variable url\nurl=sys.argv[1]\n\n#add API endpoint for reading and posting to the client game config\nactive_url=url + \"/api/config\"\n\n#Perform a get api request using the requests library\nheaders = {\n            'Content-Type': 'application/json',\n            'Accept': 'application/json'\n            }\npayload = json.dumps({})\nresponse = requests.request(\"GET\", active_url, headers=headers, data=payload)\n\n#Load the response into a dictionary\ncurrent_config = json.loads(response.text)\n\n#The current money for your player will be the value under the key \"balance\"\ncurrent_money = current_config[\"balance\"]",
                          "script_arguments": [
                            "TO DO: Select Input Variable - Client URL"
                          ],
                          "script_queries": [
                            {
                              "script_query": "current_money",
                              "script_query_name": "current_money",
                              "script_query_type": "integer"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_025ZDVCH6BKPU6CXv4CfVlvhLQoFmScnLyG",
                        "name": "Update Row in Table",
                        "title": "Update Game Record",
                        "type": "core.updaterowintable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "columns": [
                            {
                              "column_name": "Money",
                              "column_type": "string"
                            }
                          ],
                          "continue_on_failure": false,
                          "description": "This Active Block updates the player balance stored in the global game record.",
                          "display_name": "Update Game Record",
                          "input_table": "$global.variable_025XHXMLGMOMJ2XM9pFRenhgvFxor99IE66.global.variable_025XHXMLGMOMJ2XM9pFRenhgvFxor99IE66$",
                          "row": [
                            {
                              "key": "Money",
                              "type": "string",
                              "value": "$activity.definition_activity_025ZDVCG4BZQU3PFrR6qQTOVFlGjvQiyjnH.output.script_queries.current_money$"
                            }
                          ],
                          "rows": {
                            "rows_matching_criteria": true,
                            "where_clause": "Attendee == \"TO DO: Select Input Variable - Participant Name\""
                          },
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_025ZDVCJM5S124BnrLmeWWBE7AeLluTujIE",
                        "name": "Update Leaderboard",
                        "title": "Update Leaderboard",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Update Leaderboard",
                          "input": {
                            "variable_workflow_025WYK2XGMXNN4WQCdQAzF3mDJmqogdr1cy": "TO DO: Enter URL Variable"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "no_target": true
                          },
                          "workflow_id": "definition_workflow_025WY88BJWUHQ4dCkcfr3zs1ZVRTZkkvcEH",
                          "workflow_name": "Update Leaderboard"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_025ZDVCKS9PSI2NpEM5JdxiL0YxkH9lL9ve",
                        "name": "Set Variables",
                        "title": "Increment Counter",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Increment Counter",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5.local.variable_workflow_025ZDVC7FXSD10HOhiDIE3zMYFgrWWRazLk$",
                              "variable_value_new": "$workflow.definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5.local.variable_workflow_025ZDVC7FXSD10HOhiDIE3zMYFgrWWRazLk$+1"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_025ZDVCLLPCE16uDB9bCP12Z3z1Yz6L4JYK",
                        "name": "Sleep",
                        "title": "Wait Before Next Polling Interval",
                        "type": "core.sleep",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Wait Before Next Polling Interval",
                          "skip_execution": false,
                          "sleep_interval": 4
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_025ZDVCMFWDBN7TmJhJDZHAkZYa0UChRUnG",
                "name": "Select from Table",
                "title": "Generate Results String",
                "type": "core.selectfromtable",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "columns": [
                    {
                      "column_name": "Attendee",
                      "column_type": "string"
                    },
                    {
                      "column_name": "Money",
                      "column_type": "string"
                    },
                    {
                      "column_name": "Email",
                      "column_type": "string"
                    },
                    {
                      "column_name": "Game_id",
                      "column_type": "string"
                    }
                  ],
                  "continue_on_failure": false,
                  "description": "This Activity Block filters our global game record and creates a string we can import into the following python function.",
                  "display_name": "Generate Results String",
                  "input_table": "$global.variable_025XHXMLGMOMJ2XM9pFRenhgvFxor99IE66.global.variable_025XHXMLGMOMJ2XM9pFRenhgvFxor99IE66$",
                  "number_of_rows": {
                    "all_rows": true
                  },
                  "persist_output": false,
                  "skip_execution": false,
                  "sorting": {
                    "no_sort": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_025ZDVCNYVMVN5wNtgrukkgkUFV8GVM9fhb",
                "name": "Execute Python Script",
                "title": "Compute Player with Max Earnings",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "description": "This Python function determined who has the maximum earnings during the game time. The winning name is sent to the email Atomic Function.",
                  "display_name": "Compute Player with Max Earnings",
                  "script": "import sys, json, math\n\n#Load the string representation of our global data record into \"final_results\"\nfinal_results=json.loads(sys.argv[1])\nscore_list=[]\n\n#Create a list of only earnings values\nfor result in final_results:\n  if result[\"Attendee\"] != \"\":\n     score_list.append(int(result[\"Money\"]))\n\n#Determine the maximum earnings\nwinning_score=max(score_list)\n\n#Determine which player had the maximum earnings\nfor result in final_results:\n  if result[\"Attendee\"] != \"\":\n    if winning_score==int(result[\"Money\"]):\n      winning_name=result[\"Attendee\"]",
                  "script_arguments": [
                    "$activity.definition_activity_025ZDVCMFWDBN7TmJhJDZHAkZYa0UChRUnG.output.response_body$"
                  ],
                  "script_queries": [
                    {
                      "script_query": "winning_name",
                      "script_query_name": "winning_name",
                      "script_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_025ZDVCPJCI1V7cpCbNp31xC80Kjxhn7lix",
                "name": "Send Congratulations Email",
                "title": "Send Congratulations Email",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "This Atomic Function sends an email to all players thanking them for playing SecureX Blackjack!",
                  "display_name": "Send Congratulations Email",
                  "input": {
                    "variable_workflow_025R4XYAQKL101RsrpvPgwcf8dgs8JKF16f": "$activity.definition_activity_025ZDVCNYVMVN5wNtgrukkgkUFV8GVM9fhb.output.script_queries.winning_name$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "no_target": true
                  },
                  "workflow_id": "definition_workflow_025KXZZ522PI52xzHm3Z0DXEUvAwQesJAD5",
                  "workflow_name": "Winner Email"
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_025ZDVCQUFBAQ04mAvPN5lTTDQB9BDk7RZQ",
            "name": "Condition Branch",
            "title": "All Tests Passed - Re-run outside of a Test Run!",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": {
                    "left_operand": "",
                    "operator": "eq",
                    "right_operand": "TO DO"
                  },
                  "operator": "and",
                  "right_operand": {
                    "left_operand": "$workflow.definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5.input.variable_workflow_025ZDVC7FY2YS2uds4OknazVgIsPiKkIwyh$",
                    "operator": "eq",
                    "right_operand": true
                  }
                },
                "operator": "and",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5.local.variable_workflow_025ZDVC7FXGYU6ZruESuGRYbgYrdZt40R6O$",
                  "operator": "eq",
                  "right_operand": true
                }
              },
              "continue_on_failure": false,
              "display_name": "All Tests Passed - Re-run outside of a Test Run!",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_025ZDVCRXBANL7HUNdYVlaqVm58FA5yqHg0",
                "name": "Completed",
                "title": "All Tests Passed!",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "All Tests Passed!",
                  "result_message": "Please re-run this workflow outside of a test run!",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_025ZDVCSN90QD1NqYHfsXZpTzM3Edu7PiHR",
            "name": "Condition Branch",
            "title": "Tests Failed Or Not Implemented",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "",
                  "operator": "eq",
                  "right_operand": "TO DO"
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_025ZDVC78F9BL6tMzrGJkNxxvYtH52FPPX5.local.variable_workflow_025ZDVC7FXGYU6ZruESuGRYbgYrdZt40R6O$",
                  "operator": "eq",
                  "right_operand": false
                }
              },
              "continue_on_failure": false,
              "display_name": "Tests Failed Or Not Implemented",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_025ZDVCTPSRTE58m1AOtv4QaoaTa59xy7Le",
                "name": "Completed",
                "title": "Failed Test Conditions Exception",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed Test Conditions Exception",
                  "result_message": "Please ensure all tests are passed and implemented.",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "variables": {
    "variable_025R2OZ4IU8AH1cybIGaZ71aQ8d6OxuxKrQ": {
      "unique_name": "variable_025R2OZ4IU8AH1cybIGaZ71aQ8d6OxuxKrQ",
      "properties": {
        "value": true,
        "scope": "global",
        "name": "Start Game",
        "type": "datatype.boolean",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_025XHXMLGMOMJ2XM9pFRenhgvFxor99IE66": {
      "unique_name": "variable_025XHXMLGMOMJ2XM9pFRenhgvFxor99IE66",
      "schema_id": "tabletype_025XHWDRE7FCX2X9l7ynqYiGwELiygUT7xR",
      "properties": {
        "value": [
          {
            "column_data": {
              "Attendee": "",
              "Email": "",
              "Game_id": "",
              "Money": "",
              "Start_time": "",
              "URL": ""
            }
          },
          {
            "column_data": {
              "Attendee": "MatthewQuarisa",
              "Email": "12mwq@queensu.ca",
              "Game_id": "9040773012",
              "Money": "100",
              "Start_time": "15:32:03",
              "URL": "https://app-8080-490104014917794163.devenv-prod.us-west-1.devnetcloud.com"
            }
          },
          {
            "column_data": {
              "Attendee": "MatthewQuarisa1234",
              "Email": "matthew_quarisa@hotmail.com",
              "Game_id": "5088858727",
              "Money": "250",
              "Start_time": "15:43:23",
              "URL": "https://app-8080-490104014917794163.devenv-prod.us-west-1.devnetcloud.com"
            }
          }
        ],
        "scope": "global",
        "name": "XDR Blackjack Game Record",
        "type": "datatype.table",
        "description": "Player earnings and time history for an XDR Blackjack session.",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "table_types": {
    "tabletype_025XHWDRE7FCX2X9l7ynqYiGwELiygUT7xR": {
      "unique_name": "tabletype_025XHWDRE7FCX2X9l7ynqYiGwELiygUT7xR",
      "data_type": "datatype.tabletype",
      "display_name": "XDR Blackjack Record",
      "columns": [
        {
          "name": "Money",
          "title": "Earnings",
          "type": "string"
        },
        {
          "name": "Email",
          "title": "Email",
          "type": "string"
        },
        {
          "name": "URL",
          "title": "Client URL",
          "type": "string"
        },
        {
          "name": "Game_id",
          "title": "Game Id",
          "type": "string"
        },
        {
          "name": "Start_time",
          "title": "Start Time",
          "type": "string"
        },
        {
          "name": "Attendee",
          "title": "Player Name",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "atomic_workflows": [
    "definition_workflow_025V8SI32E1I61pxPwmzoVOSRbgkfQ9B0qh",
    "definition_workflow_025WY88BJWUHQ4dCkcfr3zs1ZVRTZkkvcEH",
    "definition_workflow_025KXZZ522PI52xzHm3Z0DXEUvAwQesJAD5"
  ],
  "dependent_workflows": [
    "definition_workflow_025V8SI32E1I61pxPwmzoVOSRbgkfQ9B0qh",
    "definition_workflow_025WY88BJWUHQ4dCkcfr3zs1ZVRTZkkvcEH",
    "definition_workflow_025KXZZ522PI52xzHm3Z0DXEUvAwQesJAD5"
  ]
}